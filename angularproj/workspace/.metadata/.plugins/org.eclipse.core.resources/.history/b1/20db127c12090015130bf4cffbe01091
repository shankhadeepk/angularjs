<!DOCTYPE html>
<html lang="en-US">
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular-resource.js"></script>
<body ng-app="myApp">
<h2>Item List</h2>
<div ng-controller="myCtrl1">
  <ul>
    <li ng-repeat="x in items">
        {{x.productname+" "+x.quantity}}    
    </li>
  </ul>
  <h2>Add Item</h2>
  <p>Product Name : <input type="text" ng-model="productname">
  Quantity : <input type="text" ng-model="quantity"></p>
  <input type="button" id="adddetails" value="ADD" ng-click="addNames()"/>
  <input type="button" id="update" value="UPDATE" ng-click="updateProduct()"/> 
  <input type="button" id="update" value="GET DATA" ng-click="getDatafromProductService()"/> 
  <p>Data from service : {{message}}</p>
  <p>Updated products</p>
  <table>
  	<tr ng-repeat="prod in products">
  		<td>{{prod.productname}}</td>
  		<td>{{prod.quantity}}</td>
  	</tr>
  </table>
</div>
<script>
var myModule=angular.module('myApp',['ngResource']);
myModule.factory("Post",function($resource){
	return $resource("http://localhost:8181/restfulapp/json/product/get")
});
myModule.controller('myCtrl1',function($scope,$http,Post){	
    $scope.productname="";
    $scope.quantity="";
    $scope.items=[
        {productname:'Books',quantity:'1'},
        {productname:'Laptop',quantity:'5'},
        {productname:'Pens',quantity:'10'}

    ];
    $scope.addNames=function(){
        $scope.items.push({productname:$scope.productname,quantity:$scope.quantity});
        $scope.productname="";
        $scope.quantity="";
    }
    $scope.updateProduct=function(){    	
    	var req = {
    			 method: 'POST',
    			 url: 'http://localhost:8080/service/json/product/post',
    			 headers: {
    			   'Content-Type': 'application/json'
    			 },
    			 data: JSON.stringify($scope.items)
    			}

    			$http(req).success(function(data, status, headers, config){$scope.products=data;}).error(function(data, status, headers, config){alert('Failed')});
    }
    $scope.update=function(){    	   	
    	var res=$http.post('http://localhost:8080/service/json/product/post',$scope.items);
    	res.success(function(data, status, headers, config){
    		    		$scope.products=data;	
    		    });
    	res.error(function(data, status, headers, config){
    		    	alert("Failure :"+ JSON.stringify({data: data}));
    		    });
    }
    $scope.getData=function(){
    	$http({
    		url: 'http://localhost:8080/service/json/product/get',
            method: "GET",
            data: {},
            headers: {'Content-Type': 'application/json'}
    	}).success(function (data, status, headers, config){
    		$scope.message=data;
    	}).error(function(data, status, headers, config){
    		$scope.status = status + ' ' + headers;
    	});
    } 
    $scope.getDatafromService=function(){
    	Post.get({},function(data){    		
    		$scope.message=data;
    	})
    }
    $scope.getDatafromProductService=function() {
    $http.get('http://localhost:8080/service/json/product/get').
        success(function(data) {
            $scope.message = data;
        });
}
    
});
</script>
</body>
</html> 